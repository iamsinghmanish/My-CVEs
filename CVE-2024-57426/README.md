# CVE-2024-57426: DLL Injection in NetMod VPN Client 5.3.1

## Description
NetMod VPN Client 5.3.1 is vulnerable to DLL injection, allowing an attacker to execute arbitrary code by placing a malicious DLL in a directory where the application loads dependencies. This vulnerability arises due to the improper validation of dynamically loaded libraries.


## Impact
Successful exploitation of this vulnerability enables privilege escalation, allowing an attacker to execute arbitrary code with elevated privileges. This could lead to system compromise, unauthorized access, and potential persistence on the affected machine.
## Affected System
- **Vendor:** eichgee
- **Product:** NetMod VPN Client
- **Version:** ```5.3.1```
- **Affected Components:**
    - C:\Program Files (x86)\NetMod\dcomp.dll
    - C:\Program Files (x86)\NetMod\CRYPTSP.dll
    - C:\Program Files (x86)\NetMod\RichEd20.dll
    - C:\Program Files (x86)\NetMod\WindowsCodecs.dll
    - C:\Program Files (x86)\NetMod\DWMAPI.dll
    - C:\Program Files (x86)\NetMod\ncrypt.dll
    - C:\Program Files (x86)\NetMod\NTASN1.dll
    - C:\Program Files (x86)\NetMod\D3DCOMPILER_47.dll
    - C:\Program Files (x86)\NetMod\WINMM.dll
      
## Attack Vectors
An attacker can craft a malicious DLL and place it in a directory where NetMod VPN Client searches for dependencies. When the application is executed, it loads the rogue DLL instead of a legitimate one, resulting in arbitrary code execution. Since NetMod VPN Client typically runs with elevated privileges, the injected code inherits the same permissions, leading to privilege escalation.

## Vulnerability Classification
- [CWE-94: Improper Control of Generation of Code (‘Code Injection’)](https://cwe.mitre.org/data/definitions/94.html)
- [CWE-264: Permissions, Privileges, and Access Control](https://cwe.mitre.org/data/definitions/264.html)
- Attack Type: Local

## Proof of Concept (PoC)

We verified the DLL injection by placing a crafted DLL in the affected directory, which successfully launched calc.exe, demonstrating arbitrary code execution.

```msfvenom -f dll -p windows/exec CMD='C:\\Windows\\system32\\calc.exe' -o dcomp.dll```

![DLL Injection PoC](./NETMOD.png)

## References
[NetMod VPN Client on SourceForge](https://sourceforge.net/projects/netmodhttp/)

### Discoverers
- Manish Singh
- Astik Rawat
